<br>
<div class="white-info-parent-flex">
  <div class="container-home-info-box">
    <div class="white-info-child-box">
      <div class="big-number-green"> <%= current_user.foundation.completed_investments_count %> / <%= current_user.foundation.investments.count %></div>
      <div class="small-text-gray"> YTD Completed Investments  </div>
    </div>
    <div class="white-info-child-box">
      <div class="big-number-green"> <%= nice_money(current_user.foundation.total_forecasted_amount) %></div>
      <div class="small-text-gray"> FY Forecasted </div>
    </div>
    <div class="white-info-child-box">
      <div class="big-number-green"><%= nice_money(current_user.foundation.total_unlocked_amount) %></div>
      <div class="small-text-gray"> YTD Unlocked  </div>
    </div>
  </div>
</div>

<div class="mid-title-box">
  <div class="mid-title-flex">
    <div class="title-mid-home-page-text">
      <h3>Your Investments</h3>
    </div>
    <div class="button-right">
      <%= link_to new_investment_path, { class: "btn btn-success" } do %>
      Create an investment
      <% end %>
    </div>
  </div>
</div>


<div class="flex-tab">
  <div id="ongoing-tab" class="tablinks" onclick="openCity(event, 'ongoing')">On going investments</div>
  <div id="completed-tab" class="tablinks" onclick="openCity(event, 'completed')">Completed investments</div>
</div>

<!-- Tab content -->
<div id="ongoing" class="tabcontent">
<div class="ongoing-investments">
    <div class="table-container">
      <table class="table table-hover margin-center dropshadow-around">
        <thead>
          <tr class="white-background header-row-milestone">
            <th scope="col" width="15%"><div class="tablesorter-header-inner">NGO<i class="fas fa-arrows-alt-v margin-left-auto"></i></div></th>
            <th scope="col" width="25%"><div class="tablesorter-header-inner">Project Name<i class="fas fa-arrows-alt-v center-justified margin-left-auto"></i></div></th>
            <th scope="col" width="14%"><div class="tablesorter-header-inner">Next Milestone<i class="fas fa-arrows-alt-v center-justified  margin-left-auto"></i></div></th>
            <th scope="col" width="14%"><div class="tablesorter-header-inner">Invested Amount<i class="fas fa-arrows-alt-v center-justified margin-left-auto"></i></div></th>
            <th scope="col" colspan="2" width="30%" style="text-align: center;">Edit</th>
          </tr>
        </thead>
      <tbody>
        <% @ongoing_investments.each do |investment| %>
          <tr class="white-background table-row-investment" data-investment-id="<%= investment.id %>">
            <td><%= investment.project.ngo.capitalize %></td>
            <td><%= investment.project.name %></td>
          <% if investment.next_milestone.days_left < 0 %>
            <td class="late"><%= investment.next_milestone.days_left %> days</td>
          <% elsif investment.next_milestone.days_left < 7 %>
            <td class="almost-late"><%= investment.next_milestone.days_left %> days</td>
          <% else %>
            <td><%= investment.next_milestone.days_left %> days</td>
          <% end %>
          <td><%= nice_money(investment.forecasted_amount) %></td>
          <td>
            <%= link_to investment_path(investment), { class: "edit-investment-button-table button-appear-hover" } do %>
            Milestone
            <% end %>
          </td>
          <td>
            <%= link_to investment_path(investment), { class: "edit-investment-button-table button-appear-hover" } do %>
            Investment
            <% end %>
          </td>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>


  </div>

  <div id="completed" class="tabcontent">

    <% unless @completed_investments.blank? %>

    <div class="completed-investments">
      <div class="table-container">
        <table class="table table-hover margin-center dropshadow-around">
          <thead>
          <tr class="white-background header-row-milestone">
            <th scope="col" width="15%"><div class="tablesorter-header-inner">NGO<i class="fas fa-arrows-alt-v margin-left-auto"></i></div></th>
            <th scope="col" width="25%"><div class="tablesorter-header-inner">Project Name<i class="fas fa-arrows-alt-v center-justified margin-left-auto"></i></div></th>
            <th scope="col" width="14%"><div class="tablesorter-header-inner">Next Milestone<i class="fas fa-arrows-alt-v center-justified  margin-left-auto"></i></div></th>
            <th scope="col" width="14%"><div class="tablesorter-header-inner">Invested Amount<i class="fas fa-arrows-alt-v center-justified margin-left-auto"></i></div></th>
            <th scope="col" colspan="2" width="30%" style="text-align: center;">Edit</th>
          </tr>
          </thead>
          <tbody>
            <% @completed_investments.each do |investment| %>
            <tr class="white-background table-row-investment" data-investment-id="<%= investment.id %>">
              <td><%= investment.project.ngo.capitalize %></td>
              <td>
                <%= link_to investment_path(investment), {class: "green-link-text"} do %>
                <%= investment.project.name %>
                <% end %>
              </td>
              <td class="completed-icon">Completed</td>
              <td><%= nice_money(investment.forecasted_amount) %></td>
              <td>
                <%= link_to edit_investment_milestone_path(investment, investment.project.nearest_milestone), { class: "edit-nearest-milestone-button-table button-appear-hover" } do %>
                <i class="fas fa-lock-open"></i>
                <% end %>
              </td>
              <td>
                <%= link_to investment_path(investment), { class: "edit-investment-button-table button-appear-hover" } do %>
                <i class="fas fa-pencil-alt"></i>
                <% end %>
              </td>
            </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
    <% end %>
  </div>

<%= content_for(:after_js) do %>
<script type="text/javascript">

    $("table").tablesorter();
  function openCity(evt, cityName) {
    // Declare all variables
    var i, tabcontent, tablinks;

    // Get all elements with class="tabcontent" and hide them
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }

    // Get all elements with class="tablinks" and remove the class "active"
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }

    // Show the current tab, and add an "active" class to the button that opened the tab
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
  }
  document.getElementById("ongoing-tab").click();

</script>
<% end %>
